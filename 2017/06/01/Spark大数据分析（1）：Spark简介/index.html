<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Spark," />





  <link rel="alternate" href="/atom.xml" title="Free Will" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/img/favicon.ico?v=5.1.0" />






<meta name="description" content="一、Spark概述1.1 Spark简介Spark是一个快速、通用、可扩展的大数据分析引擎。 它作为大数据计算平台的后起之秀，在2014年打破了Hadoop保持的基准排序（Sort Benchmark）纪录，使用206个节点在23分钟的时间里完成了100TB数据的排序，而Hadoop则是使用2000个节点在72分钟的时间里完成同样数据的排序。也就是说，Spark仅使用了十分之一的计算资源，获得了比">
<meta name="keywords" content="Spark">
<meta property="og:type" content="article">
<meta property="og:title" content="Spark大数据分析（1）：Spark简介">
<meta property="og:url" content="http://yoursite.com/2017/06/01/Spark大数据分析（1）：Spark简介/index.html">
<meta property="og:site_name" content="Free Will">
<meta property="og:description" content="一、Spark概述1.1 Spark简介Spark是一个快速、通用、可扩展的大数据分析引擎。 它作为大数据计算平台的后起之秀，在2014年打破了Hadoop保持的基准排序（Sort Benchmark）纪录，使用206个节点在23分钟的时间里完成了100TB数据的排序，而Hadoop则是使用2000个节点在72分钟的时间里完成同样数据的排序。也就是说，Spark仅使用了十分之一的计算资源，获得了比">
<meta property="og:image" content="http://omu7tit09.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-02%20%E4%B8%8A%E5%8D%889.57.56.png">
<meta property="og:image" content="http://omu7tit09.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-02%20%E4%B8%8A%E5%8D%8810.01.35.png">
<meta property="og:image" content="http://omu7tit09.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-01%20%E4%B8%8B%E5%8D%889.45.22.png">
<meta property="og:image" content="http://omu7tit09.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-01%20%E4%B8%8B%E5%8D%8811.35.14.png">
<meta property="og:image" content="http://omu7tit09.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-02%20%E4%B8%8A%E5%8D%8810.22.12.png">
<meta property="og:image" content="http://omu7tit09.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-02%20%E4%B8%8A%E5%8D%8810.34.31.png">
<meta property="og:image" content="http://omu7tit09.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-02%20%E4%B8%8A%E5%8D%8810.50.17.png">
<meta property="og:updated_time" content="2017-06-02T03:07:35.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Spark大数据分析（1）：Spark简介">
<meta name="twitter:description" content="一、Spark概述1.1 Spark简介Spark是一个快速、通用、可扩展的大数据分析引擎。 它作为大数据计算平台的后起之秀，在2014年打破了Hadoop保持的基准排序（Sort Benchmark）纪录，使用206个节点在23分钟的时间里完成了100TB数据的排序，而Hadoop则是使用2000个节点在72分钟的时间里完成同样数据的排序。也就是说，Spark仅使用了十分之一的计算资源，获得了比">
<meta name="twitter:image" content="http://omu7tit09.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-02%20%E4%B8%8A%E5%8D%889.57.56.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"hide"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>







  <title> Spark大数据分析（1）：Spark简介 | Free Will </title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  



  <!-- hexo-inject:begin --><!-- hexo-inject:end --><script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?9a21041c6a1d47620a3a748589516274";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>









  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Free Will</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-yiyu">
          <a href="/yiyu" rel="section">
            
            呓语
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/01/Spark大数据分析（1）：Spark简介/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="狗皮膏药">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/img/v.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Free Will">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Free Will" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Spark大数据分析（1）：Spark简介
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-06-01T23:14:45+08:00">
                2017-06-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Spark/" itemprop="url" rel="index">
                    <span itemprop="name">Spark</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i>
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>
            </span>
          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="一、Spark概述"><a href="#一、Spark概述" class="headerlink" title="一、Spark概述"></a>一、Spark概述</h2><h3 id="1-1-Spark简介"><a href="#1-1-Spark简介" class="headerlink" title="1.1 Spark简介"></a>1.1 Spark简介</h3><p>Spark是一个快速、通用、可扩展的大数据分析引擎。</p>
<p>它作为大数据计算平台的后起之秀，在2014年打破了Hadoop保持的基准排序（Sort Benchmark）纪录，使用206个节点在23分钟的时间里完成了100TB数据的排序，而Hadoop则是使用2000个节点在72分钟的时间里完成同样数据的排序。也就是说，Spark仅使用了十分之一的计算资源，获得了比Hadoop快3倍的速度。新纪录的诞生，使得Spark获得多方追捧，也表明了Spark可以作为一个更加快速、高效的大数据计算平台。</p>
<a id="more"></a>
<h3 id="1-2-Spark的历史"><a href="#1-2-Spark的历史" class="headerlink" title="1.2 Spark的历史"></a>1.2 Spark的历史</h3><p>Apache Spark最初是在2009年由加州伯克利大学（UC Berkeley）AMP lab实验室开发，实验室中的一些研究人员曾经用过Hadoop MapReduce，他们发现MapReduce在迭代计算和交互计算的任务上表现地效率低下。因此，Spark从一开始就是为交互式查询和迭代算法所设计的，同时还支持内存式存储和高效的容错机制。</p>
<p>2009年，关于Spark的研究论文在学术会议上发表，同年Spark项目正式诞生。其后不久，相比于MapReduce，Spark在某些任务上已经获得了10~20倍的性能提升。</p>
<p>Spark最早的一部分用户来自加州伯克利分校的其他研究小组，其中比较著名的有Mobile Millennium。作为机器学习领域的研究项目，它们利用Spark来监控并预测旧金山湾区的交通拥堵情况，仅仅过了短短的一段时间，许多外部机构也开始使用Spark。如今，像 Verizon Verizon、 NBC、Yahoo、 Spotify……都是Spark的使用者，其源码贡献者有IBM、Oracle、DataStax、BlueData、Cloudera……。</p>
<p>Spark源码托管在Github中，截至2016年3月，共有超过800名来自200多家不同公司的开发人员贡献了15000次代码提交，可见Spark的受欢迎程度。</p>
<p>此外，每年举办的全球Spark顶尖技术人员峰会Spark Summit，吸引了使用Spark的一线技术公司及专家汇聚一堂，共同探讨目前Spark在企业的落地情况及未来Spark的发展方向和挑战。Spark Summit的参会人数从2014年的不到500人暴涨到2015年的2000多人，足以反映Spark社区的旺盛人气。</p>
<p>如今Spark已经受到了国内外各大公司的青睐，如腾讯、淘宝、百度、亚马逊等公司均不同程度地使用了Spark来构建大数据分析应用，并应用到实际的生产环境中。相信在将来，Spark会在更多的应用场景中发挥重要作用。</p>
<h3 id="1-3-Spark的优点"><a href="#1-3-Spark的优点" class="headerlink" title="1.3 Spark的优点"></a>1.3 Spark的优点</h3><ul>
<li>运行速度快：Spark使用先进的DAG（Directed Acyclic Graph，有向无环图）执行引擎，以支持循环数据流与内存计算，与Hadoop的MapReduce相比，Spark基于内存的运算要快100倍以上；而基于硬盘的运算也要快10倍以上。</li>
<li>易用性：Spark支持使用Scala、Java、Python和R语言进行编程，简洁的API设计有助于用户轻松构建并行程序，并且可以通过Spark Shell进行交互式编程；</li>
<li>通用性：Spark提供了统一的解决方案。Spark可以用于批处理、交互式查询（通过Spark SQL）、实时流处理（通过Spark Streaming）、机器学习（通过Spark MLlib）和图计算（通过Spark GraphX），这些不同类型的处理都可以在同一个应用中无缝使用。</li>
<li>可融合性：Spark可以非常方便地与其他的开源产品进行融合。如Spark可以使用Hadoop的YARN和Apache Mesos作为它的资源管理和调度器，并且可以处理所有Hadoop支持的数据，包括HDFS、HBase和Cas-sandra等，不需要做任何数据迁移就可以使用Spark的强大处理能力。Spark也可以不依赖于第三方的资源管理和调度器，它实现了Standalone作为其内置的资源管理和调度框架。</li>
</ul>
<h2 id="二、Spark生态系统"><a href="#二、Spark生态系统" class="headerlink" title="二、Spark生态系统"></a>二、Spark生态系统</h2><p>在实际应用中，大数据处理主要包括以下三个类型：</p>
<ul>
<li>复杂的批量数据处理：时间跨度通常在数十分钟到数小时之间；</li>
<li>基于历史数据的交互式查询：时间阔度通常在数十秒到数分钟之间；</li>
<li>基于实时数据流的数据处理：时间跨度通常在数百毫秒到数秒之间。</li>
</ul>
<p>目前已有很多相对成熟的开源软件用于处理以上三种情境，比如，可以利用Hadoop MapReduce来进行批量数据处理，可以用Lmpala来进行交互式查询（lmpala与Hive相似，但底层引擎不同，提供了实时交互式SQL查询），对于流式数据处理可以采用开源流计算框架Storm。一些企业可能只会涉及其中部分应用场景，只需部署相应软件即可满足业务需求，但是，对于互联网公司而言，通常会同时存在以上三种场景，就需要同时部署三种不同的软件，这样做难免会带来一些问题：</p>
<ul>
<li>不同场景之间的输入输出不能做到无缝共享，通常需要进行数据格式转换</li>
<li>不同的软件需要不同的开发和维护团队，带来了较高的使用成本；</li>
<li>比较难以对同一个集群中的各个系统进行统一的资源协调和分配。</li>
</ul>
<p>Spark的设计遵循“一个软件栈满足不同应用场景”的理念，逐渐形成了一套完整的生态系统，既能够提供内存计算框架，也可以支持SQL即时查询、实时流式计算、机器学习和图计算等。因此Saprk所提供的生态系统足以应对上述三种场景，即同时支持批处理、交互式查询和流数据处理。</p>
<p>现在，Saprk生态系统已经成为伯克利数据分析软件栈BDAS（Berkeley Data Analytics Stack）的重要组成部分。BDAS的架构如图所示，从中可以看出，Spark专注于数据的处理分析，而数据的存储还是要借助于Hadoop分布式文件系统HDFS、Amazon S3等来实现的。因此，Spark生态系统可以很好地实现与Hadoop生态系统的兼容，使得现有Hadoop应用程序可以非常容易地迁移到Spark系统中。<img src="http://omu7tit09.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-02%20%E4%B8%8A%E5%8D%889.57.56.png" alt="屏幕快照 2017-06-02 上午9.57.56"><br>Spark的生态系统主要包含了Spark Core、SparkSQL、Spark Streaming、MLlib和GraphX等组件，各个组件的具体功能如下：</p>
<ul>
<li>Spark SQL实现了基于Spark的交互式查询。</li>
<li>Spark Streaming实现了实时流处理；</li>
<li>MLlib实现了很多机器学习算法；</li>
<li>GraphX实现了图计算；<br><img src="http://omu7tit09.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-02%20%E4%B8%8A%E5%8D%8810.01.35.png" alt="屏幕快照 2017-06-02 上午10.01.35"><h3 id="2-1-Spark-Core"><a href="#2-1-Spark-Core" class="headerlink" title="2.1 Spark Core"></a>2.1 Spark Core</h3>Spark Core实现了Spark的基本功能，包含任务调度、内存计算、故障恢复、部署模式、存储管理等。Spark Core中还包含了对弹性分布式数据集（Resilient distributed dataset）的API定义，RDD表示分布在多个计算节点上可以并行操作的元素集合，是Spark主要的编程抽象。Spark Core提供了创建和操作这些集合的多个API。</li>
</ul>
<h3 id="2-2-Spark-SQL"><a href="#2-2-Spark-SQL" class="headerlink" title="2.2 Spark SQL"></a>2.2 Spark SQL</h3><p>Spark SQL是Spark用来操作结构化数据的程序包。通过Spark SQL，我们可以使用SQL或HQL来查询数据。</p>
<p>Spark SQL允许开发人员直接处理RDD，同时也可查询Hive、HBase等外部数据源：<img src="http://omu7tit09.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-01%20%E4%B8%8B%E5%8D%889.45.22.png" alt="屏幕快照 2017-06-01 下午9.45.22"></p>
<p>Spark SQL的一个重要特点是支持开发者将SQL和传统的RDD编程的数据操作方式相结合，不论是使用Python、Java还是Scala，开发者都可以在单个的应用中同时使用SQL和复杂的数据分析。</p>
<p>通过与Spark所提供的丰富的计算环境进行如此紧密的结合，Spark SQL得以从其他开源数据仓库工具中脱颖而出。Spark SQL是在Spark 1.0中被引入的。</p>
<p>在Spark SQL之前，加州大学伯克利分销曾经尝试修改Apache Hive以使其运行在Spark上，当时的项目叫做Shark。现在由于Spark SQL与Spark引擎和API的结合更紧密，Shark已经被Spark SQL所取代。</p>
<h3 id="2-3-Spark-Streaming"><a href="#2-3-Spark-Streaming" class="headerlink" title="2.3 Spark Streaming"></a>2.3 Spark Streaming</h3><p>Spark Streaming基于Spark Core实现了可扩展、高吞吐和容错的的实时数据流处理。<img src="http://omu7tit09.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-01%20%E4%B8%8B%E5%8D%8811.35.14.png" alt="屏幕快照 2017-06-01 下午11.35.14"></p>
<p>现在支持的数据源有Kafka、Flume、Twitter、ZeroMQ、Ki-nesis、HDFS、S3和TCP套接字。处理后的结果可以存储到HDFS、Database或者Dashboard中。</p>
<p>Spark Streaming是将流式计算分解成一系列短小的批处理作业。这里的批处理引擎是Spark，也就是把Spark Streaming的输入数据按照批处理尺寸（如1秒）分成一段一段的数据（Stream），每一段数据都转换成Spark中的RDD，然后将Spark Streaming中对DStream的转换操作变为针对Spark中的RDD的转换操作，将RDD经过操作变成中间结果保存在内存中。</p>
<h3 id="2-4-MLlib"><a href="#2-4-MLlib" class="headerlink" title="2.4 MLlib"></a>2.4 MLlib</h3><p>MLlib是Spark对常用的机器学习功能的程序库，MLlib提供了很多机器学习算法，包括分类、回归、聚类、协同过滤、降维（dimensionality reduction）等，还提供了模型评估、数据导入等额外的支持功能。MLlib还提供了一些更底层的机器学习元素，包括一个通用的梯度下降优化算法。其中：<br>与分类和回归相关的算法包括SVM、逻辑回归、线性回归、朴素贝叶斯分类、决策树等；<br>聚类实现了K-means、高斯混合（Gaus-sian mixture）、Power Iteration Clustering（PIC）、Latent Dirichlet Allocation（LDA）和Streaming版本的K-means；<br>协同过滤实现了交替最小二乘法（Alternating Least Square，ALS）；<br>降维实现了Singular Value De-composition（SVD）和Principal ComponentAnalysis（PCA）；<br>频繁模式挖掘（frequent pat-tern mining）实现了FP-growth。</p>
<h3 id="2-5-GraphX"><a href="#2-5-GraphX" class="headerlink" title="2.5 GraphX"></a>2.5 GraphX</h3><p>GraphX是用来操作图（比如社交网络的朋友关系图）的程序库，可以进行并行的图计算，提供了关于图和图并行计算的API，集ETL、试探性分析和迭代式的图计算于一体，并且在不失灵活性、易用性和容错性的前提下获得了很好的性能。与Spark Streaming和Spark SQL类似，扩展了Spark的RDD API，能用来创建一个顶点和边都包含任意属性的有向图。GraphX还支持针对图的各种操作（比如进行分割的subgraph和操作所有顶点的mapVertices），以及一些常用图算法（比如PageRank和三角计数）</p>
<h2 id="三、Spark运行架构"><a href="#三、Spark运行架构" class="headerlink" title="三、Spark运行架构"></a>三、Spark运行架构</h2><h3 id="3-1-几个基本概念"><a href="#3-1-几个基本概念" class="headerlink" title="3.1 几个基本概念"></a>3.1 几个基本概念</h3><p><strong>RDD：</strong>是弹性分布式数据集（Resilient Distributed Dataset）的简称，是一个分布式内存的一个抽象概念，提供了一种高度受限的共享内存模型；</p>
<p><strong>DAG</strong>：是Directed Acyclic Graph（有向无环图）的简称，反映RDD之间的依赖关系；</p>
<p><strong>Executor</strong>：是运行在工作节点（Worker Node）上的一个进程，负责运行任务，并为应用程序存储数据；</p>
<p><strong>应用</strong>：用户编写的Spark应用程序</p>
<p><strong>作业</strong>：一个作业包含多个RDD及作用于相应RDD上的各种操作；</p>
<p><strong>阶段</strong>：是作业的基本调度单元，一个作业会分为多组任务，每组任务被称为“阶段”，或者也被称为“任务集”</p>
<h3 id="3-2-Spark架构设计"><a href="#3-2-Spark架构设计" class="headerlink" title="3.2 Spark架构设计"></a>3.2 Spark架构设计</h3><p>如下图所示，Spark运行架构包括集群资源管理器（Cluster Manager）、运行作业任务的工作节点（Worker Node）、每个应用的任务控制节点（Driver）和每个工作节点上负责具体任务的执行进程（Executor）。其中，集群资源管理器可以是Spark自带的资源管理器，也可以是YARN或Mesos等资源管理框架。<br><img src="http://omu7tit09.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-02%20%E4%B8%8A%E5%8D%8810.22.12.png" alt="屏幕快照 2017-06-02 上午10.22.12"></p>
<p>与Hadoop  MapReduce计算框架相比，Spark所采用的Executor有两个优点：一是利用多线程来执行具体地任务（Hadoop MR采用的是进程模型），减少任务的启动开销；二是Executor中有一个BlockManager存储模块，会将内存和磁盘共同作为存储设备，当需要多轮迭代计算时，可以将中间结果存储到这个存储模块里，下次需要时，就可以直接读该存储模块里的数据，而不需要读写到HDFS等文件系统里，因而有效减少了IO开销；或者在交互式查询场景下，预先将表缓存到该存储系统上，从而可以提高读写IO的性能。</p>
<p>总体而言，如下图所示，在Spark中，一个应用（Application）由一个任务控制节点（Driver）和若干个作业（Job）构成，一个作业由多个阶段（Stage）构成，一个阶段由多个任务（task）组成。当执行一个应用时，任务控制节点会向集群管理器（Cluster Manager）申请资源，启动Executor，并向Executor发送应用程序代码和文件，然后在Executor上执行任务，运行结束后，执行结果会返回给任务控制节点，或者写到HDFS或者其他数据库中。<br><img src="http://omu7tit09.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-02%20%E4%B8%8A%E5%8D%8810.34.31.png" alt="屏幕快照 2017-06-02 上午10.34.31"></p>
<h3 id="3-3-Spark运行基本流程"><a href="#3-3-Spark运行基本流程" class="headerlink" title="3.3 Spark运行基本流程"></a>3.3 Spark运行基本流程</h3><p>如下图所示，Spark的基本运行流程如下：</p>
<ul>
<li>1）当一个Spark应用被提交时，首先需要为这个应用构建起基本的运行环境，即由任务控制节点（Driver）创建一个Spark Context，由SparkContext负责和资源管理器（Cluster Manager）的通信以及进行资源的申请、任务的分配和监控等。Spark Context会向资源管理器注册并申请运行Executor的资源；</li>
<li>2）资源管理器为Executor分配资源，并启动Executor进程，Executor运行情况将随着“心跳”发送到资源管理器上；</li>
<li>3）Spark Context根据RDD的依赖关系构建DAG图，DAG图提交给DAG调度器（DAGScheduler）进行解析，将DAG分解成多个“阶段”（每个阶段都是一个任务集），并且计算出各个阶段之间的依赖关系，然后把一个个“任务集”提交给底层的任务调度器（Task Scheduler）进行处理；</li>
<li>4）任务在Executor上运行，把执行结果反馈给任务调度器，然后反馈给DAG调度器，运行完毕后写入数据并释放所有资源。<br><img src="http://omu7tit09.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-02%20%E4%B8%8A%E5%8D%8810.50.17.png" alt="屏幕快照 2017-06-02 上午10.50.17"></li>
</ul>
<p>总体而言，Spark运行架构具有以下特点：</p>
<ul>
<li>1）每个应用都有自己专属的Executor进程，并且该进程在应用运行期间一直驻留。Executor进程以多线程的方式运行任务，减少了多进程任务频繁的启动开销，使得任务执行变得非常高效和可靠；</li>
<li>2）Spark运行过程与资源管理器无关，只要能够获取Exector进程并保持通信即可；</li>
<li>3）Executor上有一个BlockManager存储模块，类似于键值存储系统（把内存和磁盘共同作为存储设备），在处理迭代计算任务时，不需要把中间结果写入到HDFS等文件系统，而是直接放在这个存储系统上，后续有需要时就可以直接读取；在交互式查询场景下，也可以把表提前缓存到这个存储系统上，提高读写IO性能；</li>
<li>4）任务采用了数据本地性和推测执行等优化机制。数据本地性是尽量将计算移到数据所在的节点上进行，即“计算向数据靠拢”，因为移动计算比移动数据所占的网络资源要少得多。而且，Spark采用了延时调度机制，可以在更大的程度上实现执行过程优化。比如，拥有数据的节点当前正被其他的任务占用，那么，在这种情况下是否需要将数据移动到其他的空闲节点呢？答案是不一定。因为，如果经过预测发现当前节点结束当前任务的时间要比移动数据的时间还要少，那么，调度就会等待，直到当前节点可用。</li>
</ul>
<h2 id="参考资料："><a href="#参考资料：" class="headerlink" title="参考资料："></a>参考资料：</h2><p>《Spark快速大数据分析》<br>《大数据技术与原理》</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>


    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Spark/" rel="tag"># Spark</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/06/05/Kaggle系列（1）：Kaggle 数据挖掘比赛经验分享/" rel="next" title="Kaggle系列（1）：Kaggle 数据挖掘比赛经验分享">
                <i class="fa fa-chevron-left"></i> Kaggle系列（1）：Kaggle 数据挖掘比赛经验分享
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/05/24/机器学习算法系列（19）：机器学习性能评价指标/" rel="prev" title="机器学习算法系列（19）：机器学习性能评价指标">
                机器学习算法系列（19）：机器学习性能评价指标 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/img/v.png"
               alt="狗皮膏药" />
          <p class="site-author-name" itemprop="name">狗皮膏药</p>
          <p class="site-description motion-element" itemprop="description">在隆冬，我终于知道，我身上有一个不可战胜的夏天</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">78</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">11</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">106</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#一、Spark概述"><span class="nav-text">一、Spark概述</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-Spark简介"><span class="nav-text">1.1 Spark简介</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-Spark的历史"><span class="nav-text">1.2 Spark的历史</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-Spark的优点"><span class="nav-text">1.3 Spark的优点</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#二、Spark生态系统"><span class="nav-text">二、Spark生态系统</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-Spark-Core"><span class="nav-text">2.1 Spark Core</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-Spark-SQL"><span class="nav-text">2.2 Spark SQL</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-Spark-Streaming"><span class="nav-text">2.3 Spark Streaming</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-MLlib"><span class="nav-text">2.4 MLlib</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-5-GraphX"><span class="nav-text">2.5 GraphX</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#三、Spark运行架构"><span class="nav-text">三、Spark运行架构</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-几个基本概念"><span class="nav-text">3.1 几个基本概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-Spark架构设计"><span class="nav-text">3.2 Spark架构设计</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-Spark运行基本流程"><span class="nav-text">3.3 Spark运行基本流程</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#参考资料："><span class="nav-text">参考资料：</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2016 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">狗皮膏药</span>
</div>



        

<div class="busuanzi-count">

  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv"><i class="fa fa-user"></i><span class="busuanzi-value" id="busuanzi_value_site_uv"></span></span>
  

  
    <span class="site-pv"><i class="fa fa-eye"></i><span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span>
  
  
</div>



        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->



  



  




	




  
  

  
  


  

  

  


</body>
</html>
